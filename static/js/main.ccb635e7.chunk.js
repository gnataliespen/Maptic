(this.webpackJsonpgeopins=this.webpackJsonpgeopins||[]).push([[0],{15:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"h",(function(){return r})),n.d(t,"g",(function(){return c})),n.d(t,"i",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"l",(function(){return i})),n.d(t,"a",(function(){return u})),n.d(t,"j",(function(){return s})),n.d(t,"f",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"m",(function(){return b}));var a="CLEAR_USER",r="LOGIN_USER",c="LOGIN_FAIL",o="LOGOUT",l="CREATE_DRAFT",i="UPDATE_DRAFT",u="CLEAR_DRAFT",s="NEW_PIN",m="GET_PINS",p="SET_PIN",d="CLEAR_PIN",f="DELETE_PIN",b="UPDATE_PIN"},20:function(e,t,n){"use strict";var a=n(0);t.a=Object(a.createContext)({currentUser:null,isAuth:!1,draft:null,pins:[],currentPin:null,alerts:[],modal:""})},288:function(e,t,n){e.exports=n(504)},437:function(e,t){},500:function(e,t,n){},504:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(34),o=n.n(c),l=n(37),i=n(29),u=n(252),s=n(520),m=n(526),p=n(75),d=n(277),f=n(84),b=n.n(f),h=n(20),g=n(118),E=n(30),y=n.n(E),v=n(68),O=function(){var e=y.a.get("token");v.a.defaults.headers.common["Content-Type"]="application/json",e?v.a.defaults.headers.common["x-auth-token"]=e:delete v.a.defaults.headers.common["x-auth-token"]},j=n(15),w=function(){var e=Object(a.useContext)(h.a).dispatch,t=Object(i.b)();return r.a.createElement(g.GoogleLogout,{onLogoutSuccess:function(){y.a.remove("token"),O(),e({type:j.i}),t.show("Logged out",{type:"success"})},onFailure:function(){t.show("Could not log out",{type:"error"})},buttonText:"Signout"})},C=n(22),P=n.n(C),k=n(33),x=function(){var e=Object(a.useContext)(h.a).dispatch,t=Object(i.b)(),n=function(){var n=Object(k.a)(P.a.mark((function n(a){var r,c;return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=a.getAuthResponse().id_token,y.a.set("token",r,{expires:1/24}),O(),n.prev=3,n.next=6,v.a.get("/auth/google");case 6:c=n.sent,e({type:j.h,payload:c.data}),t.show("Logged in",{type:"success"}),n.next=17;break;case 11:return n.prev=11,n.t0=n.catch(3),y.a.remove("token"),O(),e({type:j.g}),n.abrupt("return",t.show("Could not log in",{type:"error"}));case 17:case"end":return n.stop()}}),n,null,[[3,11]])})));return function(e){return n.apply(this,arguments)}}();return r.a.createElement(g.GoogleLogin,{clientId:"290023638438-s1t0rbg3nma81a2vh8s3tb6m7c0ijd6d.apps.googleusercontent.com",onSuccess:n,onFailure:function(){t.show("Google auth failed",{type:"error"}),e({type:j.g})},isSignedIn:!0})},N=function(){var e=Object(a.useContext)(h.a).state,t=e.isAuth,n=e.currentUser,c=b()({maxWidth:775})?{display:"none"}:null,o=b()({maxWidth:355})?{display:"none"}:null;return r.a.createElement(m.a,{id:"menu",inverted:!0},r.a.createElement(m.a.Item,{header:!0,id:"primary"},r.a.createElement(p.a,{name:"map",size:"large",color:"yellow"}),r.a.createElement("h1",{style:o},"Maptic")),t?r.a.createElement(a.Fragment,null,r.a.createElement(m.a.Item,{header:!0,className:"user"},r.a.createElement(d.a,{avatar:!0,circular:!0,src:n.picture,style:o})," ",r.a.createElement("h2",{style:c},n.name)),r.a.createElement(m.a.Item,{position:"right"},r.a.createElement(w,null))):r.a.createElement(m.a.Item,{header:!0},r.a.createElement(x,null),r.a.createElement("p",{className:"login-body",style:c}," ","or leave an anonymous pin")),r.a.createElement(m.a.Item,{header:!0,className:"instructions",position:t?null:"right",style:c},r.a.createElement(p.a,{name:"location arrow",color:"yellow"}),r.a.createElement("p",{className:"login-body"}," Click on the map to get started")))},_=n(166),D=n(25);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(n,!0).forEach((function(t){Object(D.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I,L=function(e,t){var n=t.type,a=t.payload;switch(n){case j.h:return S({},e,{currentUser:a,isAuth:!0});case j.c:case j.g:case j.i:return S({},e,{currentUser:null,isAuth:!1});case j.d:return S({},e,{currentPin:null,draft:{latitude:0,longitude:0}});case j.l:return S({},e,{draft:a});case j.a:return S({},e,{draft:null});case j.j:return S({},e,{draft:null,pins:[].concat(Object(_.a)(e.pins),[a])});case j.f:return S({},e,{pins:Object(_.a)(a)});case j.k:return S({},e,{currentPin:a,draft:null});case j.b:return S({},e,{currentPin:null});case j.e:var r=e.pins.filter((function(e){return e._id!==a}));return S({},e,{currentPin:null,pins:r});case j.m:var c=e.pins.map((function(e){return e._id===a._id?a:e}));return S({},e,{pins:c,currentPin:e.currentPin._id===a._id?a:e.currentPin});default:return e}},F=n(258),M=n.n(F),R=function(e){var t=e.Component,n=Object(a.useContext)(h.a).dispatch;Object(a.useEffect)((function(){(I=M()(":4000")).on("new pin",(function(e){n({type:j.j,payload:e})})),I.on("deleted pin",(function(e){n({type:j.e,payload:e})})),I.on("updated pin",(function(e){n({type:j.m,payload:e})}))}),[n]);return r.a.createElement(t,{createPin:function(e){e.token=y.a.get("token"),I.emit("create pin",e)},deletePin:function(e){var t=y.a.get("token");I.emit("delete pin",{token:t,id:e})},createComment:function(e){e.token=y.a.get("token"),I.emit("create comment",e)},deleteComment:function(e){e.token=y.a.get("token"),I.emit("delete comment",e)}})},U=n(522),T=n(525),z=n(119),G=n.n(z),W=function(){var e=Object(k.a)(P.a.mark((function e(t){var n,a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("file",t),n.append("upload_preset","ecomProject"),n.append("cloud_name","gnatscloud"),e.prev=4,e.next=7,G.a.post("https://api.cloudinary.com/v1_1/gnatscloud/image/upload",n);case 7:return a=e.sent,e.abrupt("return",a.data.url);case 11:e.prev=11,e.t0=e.catch(4),e.t0.response?console.log(e.t0.response.data.error.message):console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}();function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(n,!0).forEach((function(t){Object(D.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B={title:"",description:"",image:null,preview:""},H=function(e){var t=e.handleCreate,n=e.openModal,c=Object(a.useState)(B),o=Object(l.a)(c,2),u=o[0],s=o[1],m=Object(a.useState)(!1),f=Object(l.a)(m,2),b=f[0],g=f[1],E=Object(a.useContext)(h.a),y=E.dispatch,v=E.state,O=Object(i.b)(),w=function(e){var t=e.target,n=t.name,a=t.value,r=t.files;s(q({},u,"media"===n?{preview:window.URL.createObjectURL(r[0]),image:r[0]}:Object(D.a)({},n,a)))},C=function(){var e=Object(k.a)(P.a.mark((function e(n){var a,r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),g(!0),a={title:u.title.trim(),description:u.description.trim(),longitude:v.draft.longitude,latitude:v.draft.latitude},e.prev=3,!u.image){e.next=9;break}return e.next=7,W(u.image);case 7:r=e.sent,a.image=r;case 9:t(a),s(B),O.show("Created pin",{type:"success"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),O.show("Failed to create pin",{type:"error"});case 17:g(!1);case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"form"},r.a.createElement("h2",{style:{color:"green"}},r.a.createElement(p.a,{name:"location arrow"})," Pin location"),r.a.createElement(U.a,{loading:b},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(U.a.Input,{name:"title",placeholder:"Whats it called?",onChange:w,value:u.title}),r.a.createElement("input",{name:"media",accept:"image/*",id:"file-upload",type:"file",onChange:w}),r.a.createElement("label",{htmlFor:"file-upload"},r.a.createElement("div",{className:"save-btn"},r.a.createElement(p.a,{name:"image",size:"large"})))),r.a.createElement(d.a,{src:u.preview,rounded:!0,centered:!0,size:"small",onClick:n}),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(U.a.TextArea,{name:"description",placeholder:"Tell us about it...",onChange:w,value:u.description})),r.a.createElement("div",{className:"btns"},r.a.createElement(T.a,{color:"purple",onClick:function(){y({type:j.a}),s(B)}},r.a.createElement(p.a,{name:"trash",size:"small"})," Discard"),r.a.createElement(T.a,{type:"submit",color:"green",onClick:C,disabled:!u.title.trim()},r.a.createElement(p.a,{name:"save",size:"small"})," Submit"))))},K=n(528),Q=n(527),V=n(521),X=n(516);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(n,!0).forEach((function(t){Object(D.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $={image:null,text:"",preview:""},ee=function(e){var t=e.handleCreate,n=e.openModal,c=Object(a.useState)($),o=Object(l.a)(c,2),u=o[0],s=o[1],m=Object(a.useState)(!1),f=Object(l.a)(m,2),b=f[0],g=f[1],E=Object(a.useContext)(h.a).state.currentPin,y=Object(i.b)(),v=function(){var e=Object(k.a)(P.a.mark((function e(t){var n,a,r,c;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target,a=n.name,r=n.value,c=n.files,s(Z({},u,"media"===a?{image:c[0],preview:window.URL.createObjectURL(c[0])}:{text:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(k.a)(P.a.mark((function e(n){var a,r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),g(!0),a={text:u.text,pinId:E._id},e.prev=3,!u.image){e.next=9;break}return e.next=7,W(u.image);case 7:r=e.sent,a.image=r;case 9:t(a),s($),y.show("Posted comment",{type:"success"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),y.show("Failed to post comment",{type:"error"});case 17:g(!1);case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(a.Fragment,null,r.a.createElement(d.a,{src:u.preview,rounded:!0,centered:!0,size:"tiny",className:"comment-img",onClick:n}),r.a.createElement(U.a,{loading:b,onSubmit:function(e){return O(e)},className:"comment-form"},r.a.createElement(U.a.Field,{name:"comment",control:X.a,placeholder:"Add a comment...",onChange:v,value:u.text,required:!0}),r.a.createElement("div",{className:"comment-controls"},r.a.createElement(T.a,{type:"submit",className:"close","aria-label":"submit comment",disabled:!u.text||!u.text.trim()},r.a.createElement(p.a,{name:"send",color:"green"})),r.a.createElement("input",{name:"media",accept:"image/*",id:"file-upload",type:"file",onChange:v}),r.a.createElement("label",{htmlFor:"file-upload"},r.a.createElement("div",{className:"save-btn"},r.a.createElement(p.a,{name:"file image outline",size:"large"}))))))},te=n(524),ne=n(517),ae=n(267),re=function(e){var t=e.comments,n=e.openModal,c=e.deleteComment,o=Object(a.useContext)(h.a).state,l=o.currentUser,i=o.currentPin,u=Object(a.useCallback)((function(e){c({comment:e,pinId:i._id})}),[i._id,c]),s=Object(a.useMemo)((function(){return t.map((function(e,t){return r.a.createElement(te.a,{key:t},r.a.createElement(ne.a,null),e.author&&r.a.createElement(ae.a,{src:e.author.picture,alt:e.author.name}),r.a.createElement(te.a.Content,null,r.a.createElement(te.a.Author,{as:"h4",className:"comment-author"},e.author?e.author.name:"Anonymous",e.author&&l&&e.author._id===l._id&&r.a.createElement(p.a,{name:"trash",color:"red",onClick:function(){return u(e)}})),r.a.createElement(te.a.Metadata,null,r.a.createElement("div",null,Object(V.a)(new Date(e.createdAt),"MMM, do, yyyy"))),r.a.createElement(te.a.Text,null,e.text),e.image&&r.a.createElement(d.a,{size:"tiny",src:e.image,rounded:!0,onClick:n})))}))}),[t,l,u,n]);return r.a.createElement(a.Fragment,null,r.a.createElement(te.a.Group,null,s))},ce=function(e){var t=e.pin,n=e.createComment,a=e.openModal,c=e.deleteComment,o=t.title,l=t.description,i=t.author,u=t.createdAt,s=t.comments,m=t.image;return r.a.createElement("div",{className:"pin-content"},m&&r.a.createElement(d.a,{src:m,rounded:!0,centered:!0,size:"small",onClick:a}),r.a.createElement("h2",{className:"pin-heading"},o),r.a.createElement("h3",{className:"pin-heading"},r.a.createElement(p.a,{name:"user"}),i?i.name:"Anonymous"),r.a.createElement("h4",{className:"pin-heading"},r.a.createElement(p.a,{name:"clock"})," ",Object(V.a)(new Date(u),"MMM, do, yyyy")),l&&r.a.createElement("p",null,l),r.a.createElement(Q.a,null,r.a.createElement(ee,{handleCreate:n,openModal:a}),r.a.createElement(re,{comments:s,openModal:a,deleteComment:c})))},oe=n(234),le=n(523),ie=function(e){var t=e.Component,n=Object(oe.a)(e,["Component"]),c=Object(a.useState)(""),o=Object(l.a)(c,2),i=o[0],u=o[1],s=!!i;return r.a.createElement(a.Fragment,null,r.a.createElement(le.a,{open:s,basic:!0,closeIcon:!0,onClose:function(){u("")}},r.a.createElement(d.a,{wrapped:!0,size:"large",src:i})),r.a.createElement(t,Object.assign({},n,{openModal:function(e){u(e.target.src)}})))},ue=function(e){var t=e.createPin,n=e.deletePin,c=e.createComment,o=e.deleteComment,l=Object(a.useContext)(h.a),u=l.state,s=l.dispatch,m=u.draft,d=u.currentPin,f=u.currentUser,g=Object(i.b)(),E=b()({maxWidth:650})?"top":"right",y=!(!m&&!d),v=function(){var e=Object(k.a)(P.a.mark((function e(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(d._id),g.show("Deleted pin",{type:"success"});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(K.a,{visible:y,id:"blog",animation:"overlay",direction:E,width:"wide"},r.a.createElement("div",{className:"blog-btns"},r.a.createElement(T.a,{className:"close","aria-label":"Close pin view",onClick:function(){s(!m&&d?{type:j.b}:{type:j.a})}},r.a.createElement(p.a,{name:"remove circle"})),f&&d&&d.author&&f._id===d.author._id&&r.a.createElement(T.a,{color:"red",className:"delete",onClick:v},"Delete Pin")),!m&&d?r.a.createElement(ie,{pin:d,createComment:c,deleteComment:o,Component:ce}):r.a.createElement(ie,{handleCreate:t,Component:H}))},se=(n(500),Object(a.lazy)((function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,539))}))),me={timeout:5e3};var pe=function(){var e=Object(a.useContext)(h.a),t=Object(a.useReducer)(L,e),n=Object(l.a)(t,2),c=n[0],o=n[1];return r.a.createElement(h.a.Provider,{value:{state:c,dispatch:o}},r.a.createElement(i.a,Object.assign({template:u.a},me),r.a.createElement(N,null),r.a.createElement(a.Suspense,{fallback:r.a.createElement(s.a,{active:!0})},r.a.createElement(se,null)),r.a.createElement(R,{Component:ue})))};n(501).config(),o.a.render(r.a.createElement(pe,null),document.getElementById("root"))},68:function(e,t,n){"use strict";var a=n(119),r=n.n(a);t.a=r.a.create({baseURL:"https://maptik.herokuapp.com/"})}},[[288,1,2]]]);
//# sourceMappingURL=main.ccb635e7.chunk.js.map